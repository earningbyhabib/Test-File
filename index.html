<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>‡¶ü‡ßá‡¶Æ‡ßç‡¶™ ‡¶Æ‡ßá‡¶á‡¶≤ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ</title>
  <style>
    body { font-family: sans-serif; background: #f1f1f1; text-align: center; padding: 20px; }
    .box { background: white; padding: 20px; margin: auto; max-width: 500px; border-radius: 10px; box-shadow: 0 0 10px #aaa; }
    button { padding: 10px 20px; margin: 10px; border: none; background: #007bff; color: white; border-radius: 5px; }
    .inbox { background: #f9f9f9; padding: 10px; border-radius: 5px; text-align: left; max-height: 300px; overflow-y: auto; }
    .mail { margin-bottom: 10px; padding: 10px; background: white; border-left: 4px solid #28a745; }
  </style>
</head>
<body>
<div class="box">
  <h2>üì¨ ‡¶ü‡ßá‡¶Æ‡ßç‡¶™ ‡¶Æ‡ßá‡¶á‡¶≤</h2>
  <div id="email">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
  <button onclick="copyEmail()">üìã ‡¶ï‡¶™‡¶ø</button>
  <div class="inbox" id="inbox">üì≠ ‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Ü‡¶∏‡¶≤‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá</div>
</div>

<script>
let email = '';
let token = '';

function generateEmail() {
  fetch("https://api.mail.tm/domains")
    .then(res => res.json())
    .then(data => {
      const domain = data["hydra:member"][0].domain;
      const username = Math.random().toString(36).substring(2, 10);
      email = `${username}@${domain}`;
      document.getElementById('email').innerText = email;

      // Create account
      fetch("https://api.mail.tm/accounts", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ address: email, password: "123456" })
      })
      .then(() => loginToMailTM(email));
    });
}

function loginToMailTM(email) {
  fetch("https://api.mail.tm/token", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ address: email, password: "123456" })
  })
  .then(res => res.json())
  .then(data => {
    token = data.token;
    loadInbox();
  });
}

function loadInbox() {
  fetch("https://api.mail.tm/messages", {
    headers: { Authorization: `Bearer ${token}` }
  })
  .then(res => res.json())
  .then(data => {
    const inbox = document.getElementById('inbox');
    inbox.innerHTML = '';
    if (!data["hydra:member"].length) {
      inbox.innerHTML = '‚ùå ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶® ‡¶Æ‡ßá‡¶á‡¶≤ ‡¶®‡ßá‡¶á';
      return;
    }
    data["hydra:member"].forEach(msg => {
      const div = document.createElement('div');
      div.className = 'mail';
      div.innerHTML = `<b>‡¶™‡ßç‡¶∞‡ßá‡¶∞‡¶ï:</b> ${msg.from.address}<br><b>‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º:</b> ${msg.subject}`;
      inbox.appendChild(div);
    });
  });
}

function copyEmail() {
  navigator.clipboard.writeText(email);
  alert("‚úÖ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶ï‡¶™‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: " + email);
}

// Auto inbox refresh
setInterval(() => {
  if (token) loadInbox();
}, 10000);

// ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶§‡ßà‡¶∞‡¶ø
generateEmail();
</script>
</body>
</html>
